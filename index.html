<!DOCTYPE html>
<html lang="zh-cn">
<head>
<meta charset="UTF-8">
<title>å¥åº·BMIåˆ†æç³»ç»Ÿ</title>
<script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-database.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
body{
    margin:0;background:linear-gradient(135deg,#7733ff,#b566ff);
    font-family: "Microsoft YaHei";color:#fff;overflow:hidden;
}

/* é¡µé¢å®¹å™¨ â€” ä¸¤å±æ¨ªå‘å¸ƒå±€ */
#container{
    width:200vw;height:100vh;display:flex;
    transition:0.6s ease;
}

/* ä¸¤ä¸ªé¡µé¢å¡ç‰‡å¸ƒå±€ */
.page{
    width:100vw;height:100vh;display:flex;
    justify-content:center;align-items:center;
    padding:20px;box-sizing:border-box;
}

.card{
    width:430px;background:rgba(255,255,255,.16);
    box-shadow:0 0 20px rgba(255,255,255,.3);
    padding:30px;border-radius:18px;backdrop-filter:blur(10px);
    animation:fade .8s;
}
@keyframes fade{from{opacity:0;transform:translateY(30px)}to{opacity:1;transform:translateY(0)}}

h2{margin-bottom:15px;}
input{
    width:100%;padding:10px;margin:6px 0;border-radius:10px;
    border:none;font-size:17px;
}
button{
    width:100%;padding:12px;border:none;margin-top:15px;
    font-size:18px;color:#fff;background:#4c1fff;
    border-radius:10px;cursor:pointer;transition:.3s;
}
button:hover{background:#2201ff;transform:scale(1.05)}

/* æ•°æ®ç»“æœæ–‡å­— */
#meal,p{font-size:17px;line-height:27px}

/* ç¬¬äºŒé¡µæ»šåŠ¨å†…å®¹ */
#resultBox{width:450px;height:80vh;overflow-y:auto;padding-right:5px;}
#resultBox::-webkit-scrollbar{width:6px;}
#resultBox::-webkit-scrollbar-thumb{background:#fff;border-radius:5px;}
</style>
</head>
<body>

<div id="container">

<!-- é¡µâ‘  ç”¨æˆ·è¾“å…¥  -->
<div class="page">
<div class="card">
<h2>ğŸ“ è¾“å…¥å¥åº·ä¿¡æ¯</h2>
<input id="name" placeholder="å§“å">
<input id="height" type="number" placeholder="èº«é«˜ cm">
<input id="weight" type="number" placeholder="ä½“é‡ kg">
<input id="age" type="number" placeholder="å¹´é¾„">
<button onclick="saveUser()">ç”Ÿæˆå¥åº·æŠ¥å‘Š</button>
<p id="msg"></p>
</div>
</div>

<!-- é¡µâ‘¡ ç»“æœå±•ç¤ºé¡µ  -->
<div class="page">
<div class="card" id="resultBox">
<h2 id="titleName">ğŸ½ å¥åº·æŠ¥å‘Š</h2>

<h3>ğŸ“Œ æ¨èä¸‰é¤</h3><p id="meal"></p><hr>

<h3>âš  å¸¸è§é«˜çƒ­é‡é£Ÿç‰©</h3>
<p>ç‚¸é¸¡(450) è–¯æ¡(365) å¥¶èŒ¶(550) æŠ«è¨(320)...</p><hr>

<h3>ğŸƒ è¿åŠ¨æ¶ˆè€—å‚è€ƒ</h3>
<p>è·‘æ­¥30åˆ†é’Ÿ=300kcal ï½œ æ¸¸æ³³1h=500kcal ï½œ éª‘è¡Œ45min=350kcal</p><hr>

<h3>ğŸ“Š ç¾¤ä½“ç»Ÿè®¡</h3>
<canvas id="chart" style="width:100%;background:#fff;border-radius:12px;padding:10px"></canvas>

<br><button onclick="back()">è¿”å›å¡«å†™</button>
</div>
</div>

</div>


<!-- =================== JS =================== -->
<script>
// Firebase Init
const firebaseConfig = {
apiKey:"AIzaSyABck4GsHq7x68LUQQ0tqPg9Lj6XoYXi1g",
authDomain:"project-2607536693074291471.firebaseapp.com",
databaseURL:"https://project-2607536693074291471-default-rtdb.firebaseio.com",
projectId:"project-2607536693074291471",
storageBucket:"project-2607536693074291471.firebasestorage.app",
messagingSenderId:"841252265184",
appId:"1:841252265184:web:b5a7db1dd06acbb55ec485",
measurementId:"G-NPGBYV26TJ"
};
firebase.initializeApp(firebaseConfig);
const db=firebase.database();


// åˆ‡æ¢ç•Œé¢å‡½æ•°
function goResult(){ document.getElementById("container").style.transform="translateX(-100vw)" }
function back(){ document.getElementById("container").style.transform="translateX(0)" }


// ä¿å­˜ + è·³è½¬
function saveUser(){
let name=document.getElementById("name").value;
let h=parseFloat(height.value)/100;
let w=parseFloat(weight.value);
let age=parseInt(ageEl.value);

if(!name||!h||!w||!age) return alert("âš  è¯·å¡«å†™å®Œæ•´!");
let bmi=(w/(h*h)).toFixed(1);

db.ref("users").push({name,height:h*100,weight:w,age,bmi});
document.getElementById("msg").innerHTML="âœ” å·²ä¿å­˜(BMI "+bmi+")";

// æ˜¾ç¤ºæ˜µç§°
document.getElementById("titleName").innerHTML="ğŸ‘¤ "+name+" çš„å¥åº·æŠ¥å‘Š";
// æ˜¾ç¤ºæ¨èé£Ÿè°±
generateMeals(bmi,age);
goResult(); // <-- é¡µé¢åˆ‡æ¢ï¼
}


// é£Ÿè°±é€»è¾‘
function generateMeals(b){
if(b<18.5) meal.innerHTML="æ—©é¤ï¼šèŠ±ç”Ÿç‡•éº¦ç²¥+é¸¡è›‹<br>åˆï¼šç‰›è‚‰æ„é¢+æ°´æœ<br>æ™šï¼šä¸‰æ–‡é±¼é¥­+é…¸å¥¶";
else if(b<=24) meal.innerHTML="æ—©é¤ï¼šå…¨éº¦+ç‰›å¥¶<br>åˆï¼šé¸¡èƒ¸æ²™æ‹‰+ç³™ç±³<br>æ™šï¼šè”¬èœæ±¤+é¸¡è›‹";
else meal.innerHTML="æ—©é¤ï¼šé»‘å’–å•¡+è›‹ç™½<br>åˆï¼šè¥¿å…°èŠ±é¸¡èƒ¸<br>æ™šï¼šæ¸…ç‚’è”¬èœ+ç‰ç±³";
}


// é¥¼å›¾ç»Ÿè®¡
let chart=new Chart(chart,{
type:"doughnut",
data:{labels:["æ­£å¸¸","è¶…é‡"], datasets:[{data:[0,0],backgroundColor:["#4cff88","#ff3a3a"]}]}
});
db.ref("users").on("value",snap=>{
let n=0,o=0;
snap.forEach(v=>v.val().bmi<=24?n++:o++);
chart.data.datasets[0].data=[n,o];
chart.update();
});
</script>
</body>
</html>
